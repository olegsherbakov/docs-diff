<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta charset="UTF-8" />
    <title>DocsDiff application demo page</title>
    <link rel="stylesheet" type="text/css" href="./dist/main.css" />
  </head>
  <body>
    <div id="app"></div>

    <!-- Dependencies -->
    <script src="./node_modules/react/umd/react.development.js"></script>
    <script src="./node_modules/react-dom/umd/react-dom.development.js"></script>
    <script src="./node_modules/redux/dist/redux.js"></script>
    <script src="./node_modules/react-redux/dist/react-redux.js"></script>
    <script src="./node_modules/redux-thunk/dist/redux-thunk.js"></script>

    <!-- DocsDiff -->
    <script src="./dist/index.js"></script>
    <!-- Test data: selects, leftId, rightId, paragraphs -->
    <script src="./data.json.js"></script>

    <script>
      (function () {
        /* test example */
        var myApplication = function () {
          var _forceUpdate, _prev, _next;
          var _keysHandler = function (e) {
            if (e.keyCode === 37) {
              // left
              _prev();
            }
            if (e.keyCode === 39) {
              // right
              _next();
            }
          };

          return {
            on: function (forceUpdate, prev, next) {
              _forceUpdate = forceUpdate;
              _prev = prev;
              _next = next;

              window.addEventListener(`resize`, _forceUpdate);
              window.addEventListener('keydown', _keysHandler);
            },
            off: function () {
              window.removeEventListener(`resize`, _forceUpdate);
              window.removeEventListener('keydown', _keysHandler);

              _forceUpdate = undefined;
              _prev = undefined;
              _next = undefined;
            }
          };
        };
        var application = myApplication();
        var docsDiffDestroy = DocsDiff.default({
          target: document.getElementById('app'),
          onCreate: function (forceUpdate, prev, next) {
            application.on(forceUpdate, prev, next);
          },
          loadSelects: function (failFn) {
            return [selects, leftId, rightId];
            /* or return promise for example
            return new Promise(resolve => {
              setTimeout(function() {
                resolve([selects, leftId, rightId]);
              }, 3333);
            });*/
          },
          loadList: function (leftId, rightId, failFn) {
            return paragraphs;
            /* return promise for for example
            return new Promise(resolve => {
              setTimeout(function() {
                resolve(paragraphs);
              }, 3333);
            });*/
          }
        });

        setTimeout(function () {
          docsDiffDestroy();
          application.off();

          alert('unmount after 100 seconds... this is demo access ;)');
        }, 100 * 1000);
      })();
    </script>
  </body>
</html>
